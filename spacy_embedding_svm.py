import pandas as pd
import spacy
import csv
from sklearn.model_selection import train_test_split
from sklearn.linear_model import SGDClassifier
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.metrics import accuracy_score, classification_report
from sklearn.pipeline import Pipeline
from sklearn.linear_model import SGDClassifier
from sklearn.feature_extraction.text import TfidfTransformer

csv_path_cleaned = 'files/data_cleaned.txt'
df = pd.read_csv(csv_path_cleaned, header = None, names = ['Category', 'Text'], sep =' ')
X = df['Text']
y = df['Category']
nlp = spacy.load('en_core_web_lg')

sentence_embeddings = []
#X = X[:10]
#y = y[:10]
for row in X:
    sentence_embeddings.append(nlp(row).vector)

with open("spacy_sent_embeddings_all_data.csv",'w') as resultFile:
    wr = csv.writer(resultFile, dialect='excel')
    wr.writerow(sentence_embeddings)

sent_sports1 = "sign cbssports com cbssports com sports maxpreps scout sportsline shop play golf stubhub follow cbs sports sports hq fantasy home play baseball football basketball hockey teams nfl home scores schedule standings draft teams stats players injuries transactions power rankings fantasy super bowl cbs access nfl shop stubhub ncaa bb home scores schedule standings bracketology rankings stats cbk live teams players expert picks odds cbs sports classic ncaa tourney printable bracket conf tourneys top classes nba draft college shop stubhub nba home scores schedule standings stats teams players injuries transactions expert picks odds power rankings nba draft prospect rankings mock drafts nba shop stubhub mlb home scores schedule standings stats teams players transactions world series fantasy stubhub golf ncaa fb nhl mma wwe boxing soccer aaf nascar tennis crossfit olympics horse racing shop pbr tough mudder prca stubhub play golf play games play fantasy baseball play franchise football view leagues fantasy football fantasy baseball fantasy basketball fantasy hockey see sports games watch sports news network watch cbs sports network cbssn channel finder watch cbs sports hq tv shows listings watch college basketball live sportslive skratch golf watch pga tour live listen cbs sports radio listen live fantasy baseball today previewing every team h ago cbs sports radio jonah keri podcast podcasts jim rome show log log email member id password show password forgot password account sign help us careers advertise site map newsletters mobile apps college network ad choice closed captioning privacy terms mobile user agreement cbs interactive rights reserved cbs sports registered trademark cbs broadcasting inc"
sent_sports2 = "hockey training aids hockey training tips videos hockeyshot img height width style display none src https www facebook com tr id amp ev pageview amp noscript facebook like close javascript seems disabled browser must javascript enabled browser utilize functionality website cart recently added item items shopping cart us usa canada europe contact us account free shipping orders promo code needed free shipping orders promo code needed shooting shooting view shooting flooring tiles shooting pads passing kits radar gun goals backstops targets tarps shot strengthening aids pucks balls hockey sticks shooting crowd goes wild shooting tarp buy sauce category pass stickhandling pass stickhandling view pass stickhandling flooring tiles shooting pads passing kits home training centers passers hockey sauce stickhandling trainers pucks balls hockey sticks pass stickhandling hs extreme defender buy sauce category skating skating view skating skate able tiles home skating zones slide boards slide board pro synthetic ice skating clearance hs synthetic ice revolution tiles buy sauce category training training view training slide boards dryland training ice training training programs training clearance goaltending hs slide board pro buy sauce category goaltending goaltending view goaltending slideboards prohybrid dvd series blocker sleeve kit goaltending clearance g extreme slide board buy sauce category goaltending goaltending view goaltending slideboards prohybrid dvd series blocker sleeve kit goaltending g extreme slide board buy sauce category hs products hs products view hs products dryland flooring tiles synthetic ice shooting aids radar gun shooting pads passing aids hockey sauce stickhandling aids goals backstops slide boards hs swag line hot products premium home training center hs tiles buy sauce category hockey tips reviews contact hockeyshot account united states united states canada europe hockey tips reviews search item search search shot free shipping orders promo code needed free shipping orders promo code needed tweet follow refer friends login create account earn points sign get train barber rupke get top game latest training drills exclusive sales worry help share hockey stories email address take look privacy policy share referral link close login create account rewarded sharing referral link weekly deal sauce category shop tools step game best sellers best sellers shooting passing stickhandling skating dryland training hs synthetic ice revolution tiles regular price special price crowd goes wild shooting tarp regular price special price hs slide board pro premium home training center hs tiles allstar edition regular price special price hs sharpshooter targets hs knee hockey set regular price special price hs extreme hockey radar hs extreme shooter tutor regular price special price hs way elite passer regular price special price hs dryland flooring tiles allstar edition regular price special price diy hockey sauce combo regular price special price hs extreme passing kit regular price special price premium home training center hs tiles allstar edition regular price special price hs speed deke trainer ice shafts hs swedish stickhandling wooden ball hs extreme defender home ice skating zone revolution tiles regular price special price hs synthetic ice revolution tiles regular price special price sparx skate sharpener weber vs cowboy hs dryland flooring tiles allstar edition regular price special price hs synthetic ice revolution tiles regular price special price hs balance board regular price special price g extreme slide board package x player model view best selling products view shooting products view passing products view stickhandling products view skating products view dryland training products source hockey training aids welcome hockeyshot online source hockey training skill building products pride offering best largest selection free hockey training content always looking help players coaches hockey schools associations achieving goals get hockey training always looking edge game hockeyshot products great help keep puck handling shooting sharp summer products help prepare better next season john tavares toronto maple leafs x nhl star whether summer training play kids basement hockeyshot right tools bring element fun hockey training synthetic revolution tiles mixed passer pro extreme defender speed deke trainer favorite training aids combination work around skills patrice bergeron boston bruins stanley cup winner x olympic gold medallist x frank j selke award winner working hockeyshot great always cautious align certain brand see progressive brand care advancement game open minded extremely important ideas guy need environment like get good ideas going help best definitely provide beyond excited partnering wait see game hockey future pavel barber stickhandling specialist variety products hockeyshot provides outstanding tools something use daily ice take game next level kids camps really enjoy amanda kessel team usa olympic gold medalist always big fan shooting pucks summer hockeyshot products took another level shooting pucks dribble pass sauce practice one timers allstar tiles amazingly slick get closer real ice feeling overall products lot fun help preparing ice situations aleksander barkov florida panthers nhl star hockeyshot truly leader innovative ice hockey training products continue push envelope achieving success creating ice tools hockey player young old would happy want improve game hockeyshot way go jeremy rupke hockey hs bench boss ice never melts even degrees desert sun absolutely love revolution tiles perfect hockey training complement away rink never thought able get complete training backyard even whole family fun home ice skating zone jonathan marchessault vegas golden knights stanley cup finalist hockeyshot products helping give edge season training goal fully prepared next season bo horvat vancouver canucks nhl star love work boys hockey ice time tough get sometimes hockeyshot products help us work things need improve nothing better honing skills schedule thank hockeyshot martin st louis hockey hall fame stanley cup winner x nhl star game hockey evolving quickly stay top game constantly need work speed stickhandling hand eye coordination shooting skills hockeyshot helps push limits every single training ice extreme defender speed deke trainer got big hockey aspirations help reach dream trusting hockeyshot alexis lafreni chl rookie year nhl draft top prospect hockeyshot completely delivered weekend high performance hockey academy generously donated ice training aids giveaway items bracelets stickers unique promo codes participants kids loved using products wearing new hockeyshot swag could happier natalie spooner canadian national women team hs training aids big part ice season practice elite olympian need stay sharp products like hs tiles passer pro dangler slide board pro allow maximize performance ready big games hs products helping improve game everyday marie philip poulin x olympic gold medalist team canada captain tag hockeyshot featured wall fame friends brand friends brand exclusive offers contests updates sign newsletter sign get social join oursocial networks follow hockeyshot hockeyshot com hockeyshot ca hockeyshot eu hockeyshot inc rights reserved hockeyshot us buy us affiliate program partners hockey shows events rewards program fundraising program clearance center excellence tips resources shooting tips stickhandling passing training tips hockey mind meet coaches hs contest winners montreal canadiens partnership p g contest train barber rupke hockeyshot zone customer service contact us popular faqs knowledge base account track order testimonials become dealer hockey grant hs gift cards hassle free returns price match guarantee shipping privacy policy customer satisfaction terms use product reviews receive free items official partner los angeles kings back top"
sent_food = "insteading homesteading sustainability win gardening companion planting chart guide vegetable gardening soil building composting resources gardening gifts popular gardening articles animals chickens chicken breed guide raising baby chicks buying baby chicks best chicken breeds city living chicken friendly plants keeping chickens winter beekeeping beekeeping beginners insect hotel pollinators livestock raise goats raise pigs reasons raise sheep building natural building bamboo buildings bamboo furniture cob homes cordwood construction cordwood homes gabions build sauna moon gates earthbag homes underground homes growing furniture dry stack stone wall tiny house guide tiny houses tiny house living tiny house designs styles tiny house interiors tiny house bathrooms tiny house kitchens build tiny house tiny house cost tiny house kits tiny house builders tiny houses sale ovens stoves heaters masonry wood stoves masonry heater outdoor brick ovens outdoor stone oven outdoor earth ovens rocket mass heaters energy solar power wind power homestead diy soap recipes metal fire pits mission kitchens moss art organic mattress guide outdoor beds outdoor patio furniture pallet furniture recycled glass bottles stacking firewood food canning dehydrator recipes dirty dozen produce understanding gmo foods wooden spoons marketplace home garden product reviews online homesteading courses gardening live plants garden tools greenhouses pots planters farming beekeeping supplies ponds poultry care outdoor living outdoor furniture hammocks tables patio seating grills outdoor cooking generators portable power landscaping wheelbarrows outdoor power tools home goods kitchen search search search menu latest stories shares flowering trees shares dwarf fruit trees shares grow maintain artichoke plant shares store potatoes shares bunk bed plans stories shares cardoon plant cardoon vegetable find supermarket maybe even farmers market spiky stalky relative artichoke delicacy especially us likely find italy france spain north africa mediterranean climate perfect growing conditions tough looking andrea bertoli february newsletter get best homesteading articles straight inbox leave field empty human worry spam k shares comments insteading giveaway february one best ways live life little sufficiently take advantage wild plants sometimes right backyards pacific northwest may familiar wild edible mushrooms eastern united states may familiar variety kane jamison february shares smoker recipes heat air smoke something almost primal satisfying taste experience eating food infused flavor wood smoke chef ben vaughn says smoking takes little effort turn average cut meat something spectacular matthew flickr creative commons flavoring jennifer kaplan january pm shares morel mushroom hunting spring minnesota trees sporting new green leaves ground warm damp also time get woods look morel mushrooms morel hunting become one favorite springtime traditions husband adam introduced morels several years ago still melissa hartner january pm shares make soothing cherry honey cough drops cold flu season means one two things either time stock cough drops time make home seems like never cough drops hand need cold hit family winter decided insteading community authors january shares acid loving plants experienced gardeners know healthy productive garden one plants compatible ph soil soils important recognize many plants shrubs grasses trees require specific nutrient balance view post instagram wanted share update marlene affeld january pm shares smart small kitchen ideas small kitchens challenging especially love cook entertain easy feel walls caving cabinets open pot boil kids asking dinner ready something rash like throw leigha staffenhagen january pm shares make compost tea compost tea enjoying huge surge popularity gardening world sometimes called liquid gold gardening nutrient rich microbe rich liquid hailed disease preventative garden super boost nutrition soil tea first place michelle shall january pm shares homestead stories forcing indoor flowering bulbs looked display potted tulips daffodils grocery store let deep sigh flower perfectly coiffed stems standing tall pristine display awash color garden early several feet snow ice emily jane hills orford january shares diy headboard ideas tie bedroom together something headboard ties bedroom together set fresh sheets fluffy duvet decorative bed frame important bedroom elements headboard icing cake typically though headboards come hefty price tag end spending anywhere leigha staffenhagen january shares diy beeswax projects love beeswax natural versatile smells amazing used use soy wax everything switching beeswax idea ever used soy big diy projects anything help little self reliant also saving money insteading community authors january shares kitchen shelves declutter space kitchen serves many purposes place make morning cup coffee pack kids lunches also cook famous macaroni spend time ones love reason party always ends moving kitchen something leigha staffenhagen january pm newsletter get best homesteading articles straight inbox leave field empty human worry spam shares comments diy pokeberry ink love experimenting creating things first time made pokeberry ink playing around real instructions suppose could say going flow many poke plants yard want see shrivel elaina garcia january shares savvy small bathroom ideas whether live apartment tiny house harry potter closet small bathrooms challenge especially living roommates significant little ones coordinate shower bath times storing away toiletries get tricky leigha staffenhagen january shares bathroom rugs step shower morning step towel even worse cold tile floor find slipping around floor leaving trail water everywhere sounds lot like daily routine could probably benefit bathroom leigha staffenhagen january pm shares comments caffeine free coffee substitutes forage backyard coffee something really used enjoy memories roasted dark liquid synonymous warm cafes good conversation air perfumed delicious aromas decade past college finding appreciation flavor ubiquitous american beverage quickly eclipsed michelle shall december pm shares black bat flower exclaimed pointing black thing sat atop tall stem black thing best way could describe though perhaps avid gardeners would refer deep purple definitely black two wide flower petals flattened back like wings around emily jane hills orford december shares perennial herbs fresh garden flavor year long us green thumbs may feel bit winter blues first hard frost hits though tender sprigs favorite basil dill may look beautiful dawn strikes fatally crystallized leaves know soon formerly verdant garden beds shriveled michelle shall december shares natural roach killer unless roach loving entomologist chances stand little critters kitchen unsightly also known allergy triggers especially diagnosed asthma according pest world cockroaches said spread least kinds bacteria jessica brown december pm shares vegan gift guide items every vegan list people turning veganism compassionate health conscious lifestyle means probably least veg heads life point going occasion give gift vegan friends family office mates remove anxiety andrea bertoli december shares gifts give change world every time holidays come around find wondering heck going get special people list chances least one relative friend literally never wants anything love tradition spoiling loved ones leigha staffenhagen december shares comments microscopic images butterfly wings ever taken look microscopic images seeds already know breathtaking tiny parts nature especially placed microscope chris perani used photography skills create microscopic images butterfly wings absolutely stunning create works art chris leigha staffenhagen december shares comments try eco friendly christmas tree upcycled recycled reused eco friendly christmas trees sustainable alternative chopping living tree buying tree chopped shipped christmas tree farms classic example monoculture single crop cultivated wide area row row similar trees make keiren december newsletter get best homesteading articles straight inbox leave field empty human worry spam shares chia plants grow harvest chia seeds chia seeds nutritional powerhouses huge range versatility kitchen favorite seed use kitchen chia plants article going look grow awesome little plants easy grow beautiful look andrea bertoli december shares comments gifts chicken keepers holiday season approaches many us struggling decide get friends show thoughtfulness care without breaking bank especially hard decision make friend earth outdoorsy type care much possessions gifts get lucia wyss december shares tentree holiday gift guide search perfect gift holiday season may feel completely overwhelmed inundated number newspaper advertisements holiday sales choose anything like us insteading keeping eye high quality gift family friends leigha staffenhagen december pm shares farmhouse table plans dinner table symbol unity discuss life recent events positive negative share meals people love farmhouse tables also known harvest tables enhance familiar feeling strong sturdy tables used farmers workstations nowadays jessica brown december shares comments gardening gifts tis season gift giving since colder weather many us stuck inside instead dirt figured holiday season perfect time find best gardening gifts including gear decor reading course forget extra homesteading specialties compiled kane jamison december pm shares ingenious everyday borax uses inexpensive readily available powdered borax also known sodium tetraborate naturally occurring common boron mineral salt borax component diverse array laundry soaps bath salts hand soaps cleaning products cosmetics product homesteaders used years first discovered dry lakebeds marlene affeld november shares fireplace mantels nothing quite like warming next fire especially fireplace living room something mantel less fireplace seems mantel adds finishing touch fireplace ties whole room together though many fireplace mantels decorative others offer leigha staffenhagen november pm shares kitchen curtains picture sitting kitchen enjoying cup coffee reading paper gentle breeze escapes window sun peeks enough feel warmth cheek image complete without kitchen curtains floating softly leigha staffenhagen november shares sustainable stocking stuffers always possible buy new greenhouse build rain garden holiday gift insteading understand garden gifts easily run large expensive side want substitute love natural sustainable products plastic battery operated gadget though leigha staffenhagen november shares workbench plans regardless projects tackling chances could efficiently workbench building workbench necessarily require complex woodworking jump build consider things like primary use much space realistic jessica barrett halcom november shares grow brussels sprouts brussels sprouts really delicious tasting like mild firm cabbage basically brussels sprouts available year round global food economy really peak northern hemisphere late summer fall months cornerstone fall cooking andrea bertoli november pm newsletter get best homesteading articles straight inbox leave field empty human worry spam shares perennial vegetables years garden freshness huge variety plants choose want start garden starting garden simple throwing seeds ground consider plant sun soil water requirements well whether well suited andrea bertoli november shares indoor trees add greenery home one thinks trees visions vast swaths forested mountains steamy jungles frosty taigas may come mind every tree needs scenic backdrop flourish content live home admit things enliven bitty apartment michelle shall november shares headboards tie bedroom together decorating bedroom may find search bed frames dressers armoirs bedside tables nothing tie space together quite like headboard headboards available style adding current decor simply cherry top leigha staffenhagen november shares growing kale kale become somewhat synonymous modern health movement nutrient packed green bastion good eating centuries fact old scottish story tells young doctor traveling search town start practice advised see kale growing michelle shall november shares fast growing shade trees homestead always seems like realize lack shade backyard late already settled good book put lawn chair made nice lunch discover heat sun simply much could settle marlene affeld november shares hosta plant oh hosta huge standing front drive surveying called circle garden encased rock wall outlined circle around gracious old willow tree hosta huge expanse plant leaves rivaled emily jane hills orford november shares tentree trees planted every item sold insteading sustainability heart everything sustainability reason skip pesticides collect rainwater compost choose solar wind energy strive live self sufficiently course always search brands use sustainable materials business practices company leigha staffenhagen november shares get rid yellow jackets young son playing rocks sticks nearby pulling weeds perennial herb garden kept small frame corner eye worked smiling saw lean close ground curiosity apparently studying something fascinating michelle shall november pm shares bathroom shelves organize space ah yes bathroom one rooms tend shut door forget use know bathroom tends chaotic mess place zen relaxation think bathroom organization chances leigha staffenhagen october load congratulations reached end internet find us facebook loading stay connected facebook twitter instagram pinterest subscribe weekly updates get best homesteading articles straight inbox leave field empty human worry spam insteading com learn us subscribe contact write us advertising community rules policies back top close win gardening companion planting chart guide vegetable gardening soil building composting resources gardening gifts popular gardening articles animals chickens chicken breed guide raising baby chicks buying baby chicks best chicken breeds city living chicken friendly plants keeping chickens winter beekeeping beekeeping beginners insect hotel pollinators livestock raise goats raise pigs reasons raise sheep building natural building bamboo buildings bamboo furniture cob homes cordwood construction cordwood homes gabions build sauna moon gates earthbag homes underground homes growing furniture dry stack stone wall tiny house guide tiny houses tiny house living tiny house designs styles tiny house interiors tiny house bathrooms tiny house kitchens build tiny house tiny house cost tiny house kits tiny house builders tiny houses sale ovens stoves heaters masonry wood stoves masonry heater outdoor brick ovens outdoor stone oven outdoor earth ovens rocket mass heaters energy solar power wind power homestead diy soap recipes metal fire pits mission kitchens moss art organic mattress guide outdoor beds outdoor patio furniture pallet furniture recycled glass bottles stacking firewood food canning dehydrator recipes dirty dozen produce understanding gmo foods wooden spoons marketplace home garden product reviews online homesteading courses gardening live plants garden tools greenhouses pots planters farming beekeeping supplies ponds poultry care outdoor living outdoor furniture hammocks tables patio seating grills outdoor cooking generators portable power landscaping wheelbarrows outdoor power tools home goods kitchen facebook twitter instagram pinterest search search best homesteading resources get insteading updates straight inbox everyone else leave field empty human worry spam close"

doc1 = nlp(sent_sports1)
doc2 = nlp(sent_sports2)
doc3 = nlp(sent_food)

print("similarity doc1, doc2 ", doc1.similarity(doc2))
print("similarity doc1, doc3 ", doc1.similarity(doc3))

X_train, X_test, y_train, y_test = train_test_split(sentence_embeddings, y, test_size=0.3, random_state = 42)
print("X_train: ", len(X_train))
print("X_test: ", len(X_test))
print("y_train: ", len(y_train))
print("y_test: ", len(y_test))
classifier = SGDClassifier(loss = "hinge", penalty="l2", max_iter = 5)
classifier.fit(X_train ,y_train)

print("prediction: ", classifier.predict([doc1.vector]))
y_pred = classifier.predict(X_test)

print('accuracy linear model %s' % accuracy_score(y_pred, y_test))
print("report linear model", classification_report(y_test, y_pred,target_names=classifier.classes_))
