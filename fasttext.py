#By Alejandro Robles
#Training an CNN for text classification using the fasttext library
#this file will contain training the model and testing its results

import fasttext
import numpy as np


csv_path_train = 'files/data_cleaned_train.txt'
csv_path_test = 'files/data_cleaned_test.txt'
model_path = 'files/model'
model_clf_path = 'files/model_clf'

#uncomment this to actually create the models for the first time
#model = fasttext.skipgram(csv_path_train, model_path)
#classifier = fasttext.supervised(csv_path_train, model_clf_path)

classifier = fasttext.load_model('./files/model_clf.bin')
model = fasttext.load_model('./files/model.bin')
print(model.words) # list of words in dictionary
print(model['cooking'])

texts = ['recipes cooking best recipes web skip content toggle mobile menu recipes cooking search breakfast desserts sweets drinks dinner salads soups stews recipes cooking best recipes web food recipes amazing avocado recipes need try kaya february desserts sweets brownie recipes satisfy sweet tooth kaya february february food recipes keto recipes breakfast lunch dinner kaya february february dinner quick easy keto dinner recipes make minutes kaya january desserts sweets best valentine day dessert recipes kaya january dinner quick easy minute dinner recipes kaya january january salads best healthy easy salad recipes kaya january january food recipes easy fun christmas food ideas kaya october october food recipes best halloween party food ideas kaya september september appetizers creative halloween party appetizers kaya september september desserts sweets best halloween cake recipes kaya september september food recipes amazing avocado recipes need try kaya february avocados guacamole healthy fruit used variety ways salads side dishes continue reading desserts sweets brownie recipes satisfy sweet tooth kaya february february food recipes keto recipes breakfast lunch dinner kaya february february dinner quick easy keto dinner recipes make minutes kaya january desserts sweets best valentine day dessert recipes kaya january dinner quick easy minute dinner recipes kaya january january salads best healthy easy salad recipes kaya january january food recipes easy fun christmas food ideas kaya october october food recipes best halloween party food ideas kaya september september appetizers creative halloween party appetizers kaya september september desserts sweets best halloween cake recipes kaya september september posts navigation next recipes cooking recent posts amazing avocado recipes need try brownie recipes satisfy sweet tooth keto recipes breakfast lunch dinner quick easy keto dinner recipes make minutes best valentine day dessert recipes popular easy party food ideas kids throwing party child soon festive th july dessert recipes planning host independence day different ways make pizza people ask favorite mouthwatering fruit leather recipes love fruit leathers nutritious high energy snacks best chicken recipes need try chicken one popular foods love contact privacy policy powered wordpress theme cali athemes']
labels = classifier.predict(texts)
labels = classifier.predict_proba(texts)
print(labels)
result = classifier.test(csv_path_test)
print('P@1:', result.precision)
print('R@1:', result.recall)
print('Number of examples:', result.nexamples)


# Testing other sites
sports = "clemson clemson tigers football recruiting img height width style display none src https www facebook com tr id amp ev pageview amp noscript sports sports home nfl teams news feed draft power rankings scores schedule expert picks standings season stat leaders team stat leaders nfl top nfl injury report nba teams news feed scores schedule standings season stat leaders team stat leaders nba injury report ncaa fb teams news feed scores schedules college team talent expert picks polls player leaders team leaders videos ncaa bb teams news feed scores schedules polls player leaders team leaders fb rec fb recruiting home news feed team rankings commitments decommitments scheduled commits player rankings player search crystal ball experts recruiter rankings class calculator time top recruits transfer portal bk rec bk recruiting home news feed team rankings commitments decommitments scheduled commits player rankings player search crystal ball experts class calculator transfer portal cbs sports hq cbssports sportsline maxpreps shop stubhub follow clemson facebook twitter instagram log join news news feed latest headlines videos board football scores schedule stats roster expert picks draft history nfl draft college team talent acc schedule acc standings ncaa polls ncaa player leaders ncaa team leaders videos fb rec fb recruiting home news feed commitments decommitments scheduled commits scholarship distribution targets offers team rankings player rankings player search crystal ball latest crystal ball experts recruiter rankings official visits class calculator time commits time top recruits transfer portal basketball scores schedule stats roster ncaa player leaders ncaa team leaders videos bb rec bk recruiting home news feed commitments decommitments scheduled commits scholarship distribution targets offers team rankings player rankings player search crystal ball latest crystal ball experts official visits class calculator time commits transfer portal newsletter quotes support faq stubhub shop fb recruiting star fred davis vip anna hickey college football storylines facing clemson defense entering spring ball anna hickey fb recruiting sports crystal ball forecast blue chip cb clemson vip steve wiltfong fb recruiting div running back sets clemson visit vip anna hickey fb recruiting versatile lb db kourt williams stock rising fast greg biggins edit marquee special offer team recruiting scoop source clemson news day free trial watch play acc men college basketball acc mid season watch live new sports news network stream play bracketology last teams play highlights virginia tech clemson play acc clemson basketball clemson elijah thomas videos football schedule w w w w w w w w w w w w w w w times eastern full schedule crystal ball predictions vip luke hill cb predicted brian dohn vip fred davis ii cb predicted steve wiltfong darius snow predicted mike roach marshawn lloyd rb predicted jake rowe vip marshawn lloyd rb predicted kipp adams vip luke hill cb predicted sean fitz andrew gentry ot predicted jeff hansen vip enzo jennings ath predicted kevin sinclair darrion henry sde predicted kevin sinclair chandler morris dual predicted danny west jordan burch sde predicted demetric warren xzavier henderson wr predicted josh newberg timothy smith dt predicted josh newberg fred davis ii cb predicted josh newberg jordan burch sde predicted michael clark vip rj mickens predicted brian perroni darius snow predicted ej holland vip timothy smith dt predicted anna hickey bryan bresee sde predicted cory fravel vip jordan burch sde predicted steve wiltfong vip bryan bresee sde predicted steve wiltfong vip bryan bresee sde predicted anna hickey vip jaylan knighton rb predicted hale mcgranahan vip tee denson cb predicted stephen brooks vip tee denson cb predicted sean scherer view commitments special offer team recruiting scoop source clemson news day free trial team news fb recruiting running back sets clemson visit fb recruiting vip premium anna hickey hours ago fb recruiting versatile lb db kourt williams stock rising fast fb recruiting greg biggins feb pm fb recruiting clemson georgia main competition fb recruiting vip premium anna hickey feb pm fb recruiting school recruiting star wr better clemson fb recruiting vip premium anna hickey feb college football storylines facing clemson offense entering spring ball college football anna hickey feb pm fb recruiting justin flowe planning several season visits fb recruiting greg biggins feb pm fb recruiting clemson wanted fb recruiting vip premium anna hickey feb pm fb recruiting star lb says clemson continues pursue priority fb recruiting vip premium anna hickey feb fb recruiting last week recruiting fb recruiting vip premium anna hickey feb fb recruiting armour orlando recruiting notebook fb recruiting vip premium john garcia jr feb pm stories clemson breaking news inbox sign send email manage newsletters related news sports fb recruiting ten players know district columbia class fb recruiting brian dohn minutes ago fb recruiting ten recruits know central northern california fb recruiting brandon huffman hours ago fb recruiting star fred davis fb recruiting vip premium anna hickey hours ago college football transfer portal tracking players exploring transfer options college football chris hummer hours ago college football espn updates way early top rankings college football sam hellman hours ago stories network news feed top targets bryan bresee sde dj uiagalelei pro antoine sampah ilb jordan burch sde view commitments search recruiting rankings formula c specific team total number commits rn sports composite rating nth best commit times explanation order create comprehensive team recruiting ranking without notion bias sports team recruiting ranking solely based sports composite rating recruit weighted rankings according gaussian distribution formula bell curve team best recruit worth points think team point score sum ratings team commits best recruit worth rating value second best recruit worth nearly rating value last recruit worth small fraction rating value formula ensures commits contribute least value team score without heavily rewarding teams several commitments others readers familiar gaussian distribution formula note use varying value based standard deviation total number commits schools given sport standard deviation creates bell curve inflection point near average number players recruited per team graphical representation formula works see area curve gets smaller rating commit decreases number total commits school increases axis graph represents percentage weight score gets applied overall team ranking alabama lsu miami ohio state clemson florida texas florida state oklahoma auburn view class calculator stubhub tickets clemson football tickets clemson basketball tickets contact us advertisers member services careers customer service privacy policy terms service terms use toggle full mobile facebook twitter instagram cbs interactive rights reserved cbs sports registered trademark cbs broadcasting inc sportsradar"

sports2 = "sign cbssports com cbssports com sports maxpreps scout sportsline shop play golf stubhub follow cbs sports sports hq fantasy home play baseball football basketball hockey teams nfl home scores schedule standings draft teams stats players injuries transactions power rankings fantasy super bowl cbs access nfl shop stubhub ncaa bb home scores schedule standings bracketology rankings stats cbk live teams players expert picks odds cbs sports classic ncaa tourney printable bracket conf tourneys top classes nba draft college shop stubhub nba home scores schedule standings stats teams players injuries transactions expert picks odds power rankings nba draft prospect rankings mock drafts nba shop stubhub mlb home scores schedule standings stats teams players transactions world series fantasy stubhub golf ncaa fb nhl mma wwe boxing soccer aaf nascar tennis crossfit olympics horse racing shop pbr tough mudder prca stubhub play golf play games play fantasy baseball play franchise football view leagues fantasy football fantasy baseball fantasy basketball fantasy hockey see sports games watch sports news network watch cbs sports network cbssn channel finder watch cbs sports hq tv shows listings watch college basketball live sportslive skratch golf watch pga tour live listen cbs sports radio listen live fantasy baseball today previewing every team h ago cbs sports radio jonah keri podcast podcasts jim rome show log log email member id password show password forgot password account sign help us careers advertise site map newsletters mobile apps college network ad choice closed captioning privacy terms mobile user agreement cbs interactive rights reserved cbs sports registered trademark cbs broadcasting inc"

food = "quick easy authentic indian food recipes yummy yummy home recipe index recipe videos vegetarian recipes chicken recipes kerala sadya recipes christmas recipes mom recipes contact international american arabic greek indo chinese italian mexican pakistani kerala dishes breakfast desserts non vegetarian pickles seafood snacks vegetarian kids recipes desserts snacks north indian desserts non vegetarian snacks vegetarian variety rice biriyani fried rice pulav rice baking bread cakes cookies main course snacks prawn recipes ramadan recipes celebrating recipes counting new kerala dishes non vegetarian seafood feb unakka meen chakkakuru manga curry ingredients serves unakka meen medium small sized unakka ayala around gm chakka kuru jackfruit seeds quartered turmeric powder tsp chilly powder tsp kerala dishes pickles seafood seafood feb prawn pickle chemmeen achar ingredients makes cup chemmeen prawns gm clean rinse pat dry paper towel used cooked salad prawns turmeric powder tsp chilly powder tsp salt kerala dishes non vegetarian seafood seafood feb padavalanga unakka chemmeen aviyal snake gourd dried prawn aviyal ingredients serves padavalanga snake gourd cup sliced unakka chemmeen gm cleaned around cup green chilies slit shallots halved curry leaves turmeric powder kerala dishes vegetarian feb nellikka chathachathu ingredients serves nellikka uppilittathu gooseberries brine large pitted shallots kanthari mulaku preferred regular green chilies chopped curry leaves coconut oil kerala dishes vegetarian vegetarian jan angamali special raw mango curry ingredients serves raw mango chanacha vilanja manga preferred raw mango ripe cup peeled cut pieces turmeric powder tsp chilly powder tsp salt taste onion kerala dishes non vegetarian jan angamali style beef kaya varutharachathu ingredients serves beef kg cubed coconut oil tbsp onion cup thinly sliced shallots cup sliced ginger tsp chopped garlic chicken kerala dishes non vegetarian snacks jan vegetable chicken kothu porotta ingredients chicken chicken pieces bone boneless gm cut small pieces turmeric powder tsp chilly powder tsp coriander powder tsp garam masala powder tsp kerala dishes non vegetarian seafood seafood jan chemmeen pollichathu ingredients serves prawns chemmeen medium sized cleaned coconut oil tbsp tsp onion cup finely chopped ginger garlic finely chopped kerala dishes non vegetarian seafood jan kallumekkaya mussels roast ingredients serves kallumekkaya mussels cups cleaned turmeric powder tsp pepper powder tsp salt taste water tbsp coconut oil tbsp kerala dishes non vegetarian jan trivandrum style chicken thoran ingredients serves chicken bone kg cut small pieces turmeric powder tsp pepper powder tsp salt required coconut oil tbsp mustard seeds page last search recipes popular posts recent posts unakka meen chakkakuru manga curry feb prawn pickle chemmeen achar feb padavalanga unakka chemmeen aviyal snake gourd dried prawn aviyal feb nellikka chathachathu feb angamali special raw mango curry jan angamali style beef kaya varutharachathu jan vegetable chicken kothu porotta jan spiced chana kadala fry kadala masala feb chicken restaurant style apr gooseberry raita mar malabar style meen mulakittathu apr chena elephant yam thoran jun egg pulao may carrot thoran may ready make mark follow yummy yummy facebook instagram pinterest rss twitter youtube instagram load follow instagram kerala sadya recipes maya wife mother blogger ardent lover good food cook serve eat almost passion divine aroma fills kitchen cook bake simply keeps going recipe videos chicken mappas chinese fried rice chocolate ice cream machine eggless visit youtube channel subscribe get latest recipes delivered inbox sign enter email blogroll minterest suji cookbook travel every recipe since every recipe since select month february january december november october september august july june may april march february january december november october september august july june may april march february january december november october september august july june may april march february january december november october september august july june may april march february january december november october september august july june may april march february january december november october september august july june may april march february january december november october september august july june may april march february january december november october september august july june may april march february january december november october september august july june may april march february january copyright yummy yummy rights reserved privacy policy recipe index contact crafted matrics"

travel = "farmville home contact privacy policy home guides previews news partner site free gifts country escape tropic escape sponsor sponsor farmville free special mystery box gifts day angelo zambrano pm add comment edit special mystery box gifts waiting find many rewards like water salt pepper certicates bottles much read farmville collect coins free day angelo zambrano pm add comment edit farmville released little surprise players giving away free coins surely help lo read farmville free gypsy horse day angelo zambrano pm add comment edit gypsy horse animal available farmville baby gypsy horse available farm bucks adult gypsy horse read farmville free mustang horse day angelo zambrano pm add comment edit mustang horse farmville animal available farmville bought market baby coins read farmville free mix certificates day angelo zambrano pm add comment edit farmville offers free certificates mix loose chance get free read farmville free fertilize certificate day angelo zambrano add comment edit hi players want gift fertilize certificate links link read farmville free power time certificate day angelo zambrano add comment edit hi players want gift power time time certificate links link read farmville free double mastery certificate day angelo zambrano add comment edit double mastery certificate gives double mastery points day hi players want gift doub read farmville free water pack day angelo zambrano add comment edit water essential resource farmville needed grow seeds trees hi players want gift wi read farmville free speed grow x day angelo zambrano add comment edit speed grow farmville instantly finishes growth time crop tree wait hours harvest th read farmville free super feed pack day angelo zambrano add comment edit super feed farmville sometimes called speed feed instantly feeds animal player read farmville free prized gold shovel day angelo zambrano add comment edit special prize shovel farmville gets twice prize good points using harvest crops heirloom trees afte read subscribe posts atom sponsor recent posts sponsor partner site get google play download site app find us facebook labels farmville farmville free reward farmville certificates farmville special gifts farmville horses farmville news farmville baby bottle farmville mystery box farmville gifts mix farmville water farmville speed grow farmville super feed farmville guide farmville mustang horse farmville coins farmville fertilize certificate farmville prized showel farmville gipsy horse farmville preview free reward farmville free power farmville feed farmville country escape guide farmville country escape farmville tips farmville energy farmville favors farmville tropic escape farmville tropic escape guides farmville fertilizer farmville tropic escape news farmville free favors farmville details farmville farmbucks google contact form name email message follow email twitter tweets farmville _z copyright farmville free site endorsed affiliated zynga inc trademarks property respective owners game content materials copyright zynga inc rights reserved"

# Finding Cosine Similarities
model.cosine_similarity(sports, sports2)
model.cosine_similarity(sports2, food)
model.cosine_similarity(sports, travel)
model.cosine_similarity(food, travel)

# Getting in sample site2vec
site2vec = model[texts[0]]

# Getting site2vec embeddings of out of sample sites
sports_embedding = model[sports]
sports_embedding2 = model[sports2]

# Manually Calculating Cosine Similarity
cosinesim = dist = np.dot(sports_embedding, sports_embedding2) / (np.linalg.norm(sports_embedding) * np.linalg.norm(sports_embedding2))
modelcosine = model.cosine_similarity(sports, sports2)
print(cosinesim, modelcosine)